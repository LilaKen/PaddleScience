W1105 10:52:06.906328 2972292 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.2, Runtime API Version: 12.0
W1105 10:52:06.917985 2972292 gpu_resources.cc:164] device: 0, cuDNN Version: 9.5.
Dataloading is over.
Namespace(lr=0.001, epochs=500, weight_decay=1e-05, model='Transolver_Structured_Mesh_2D', n_hidden=256, n_layers=8, n_heads=8, batch_size=2, gpu=0, max_grad_norm=None, downsample=1, mlp_ratio=1, dropout=0.0, unified_pos=1, ref=8, slice_num=32, eval=1, save_name='ns_Transolver', data_path='data/fno')
Model(
  (preprocess): MLP(
    (linear_pre): Sequential(
      (0): Linear(in_features=74, out_features=512, dtype=None)
      (1): GELU(approximate=False)
    )
    (linear_post): Linear(in_features=512, out_features=256, dtype=None)
    (linears): LayerList()
  )
  (blocks): LayerList(
    (0): Transolver_block(
      (ln_1): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (Attn): Physics_Attention_Structured_Mesh_2D(
        (softmax): Softmax(axis=-1)
        (dropout): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        (in_project_x): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_fx): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_slice): Linear(in_features=32, out_features=32, dtype=None)
        (to_q): Linear(in_features=32, out_features=32, dtype=None)
        (to_k): Linear(in_features=32, out_features=32, dtype=None)
        (to_v): Linear(in_features=32, out_features=32, dtype=None)
        (to_out): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        )
      )
      (ln_2): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (mlp): MLP(
        (linear_pre): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): GELU(approximate=False)
        )
        (linear_post): Linear(in_features=256, out_features=256, dtype=None)
        (linears): LayerList()
      )
    )
    (1): Transolver_block(
      (ln_1): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (Attn): Physics_Attention_Structured_Mesh_2D(
        (softmax): Softmax(axis=-1)
        (dropout): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        (in_project_x): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_fx): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_slice): Linear(in_features=32, out_features=32, dtype=None)
        (to_q): Linear(in_features=32, out_features=32, dtype=None)
        (to_k): Linear(in_features=32, out_features=32, dtype=None)
        (to_v): Linear(in_features=32, out_features=32, dtype=None)
        (to_out): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        )
      )
      (ln_2): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (mlp): MLP(
        (linear_pre): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): GELU(approximate=False)
        )
        (linear_post): Linear(in_features=256, out_features=256, dtype=None)
        (linears): LayerList()
      )
    )
    (2): Transolver_block(
      (ln_1): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (Attn): Physics_Attention_Structured_Mesh_2D(
        (softmax): Softmax(axis=-1)
        (dropout): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        (in_project_x): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_fx): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_slice): Linear(in_features=32, out_features=32, dtype=None)
        (to_q): Linear(in_features=32, out_features=32, dtype=None)
        (to_k): Linear(in_features=32, out_features=32, dtype=None)
        (to_v): Linear(in_features=32, out_features=32, dtype=None)
        (to_out): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        )
      )
      (ln_2): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (mlp): MLP(
        (linear_pre): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): GELU(approximate=False)
        )
        (linear_post): Linear(in_features=256, out_features=256, dtype=None)
        (linears): LayerList()
      )
    )
    (3): Transolver_block(
      (ln_1): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (Attn): Physics_Attention_Structured_Mesh_2D(
        (softmax): Softmax(axis=-1)
        (dropout): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        (in_project_x): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_fx): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_slice): Linear(in_features=32, out_features=32, dtype=None)
        (to_q): Linear(in_features=32, out_features=32, dtype=None)
        (to_k): Linear(in_features=32, out_features=32, dtype=None)
        (to_v): Linear(in_features=32, out_features=32, dtype=None)
        (to_out): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        )
      )
      (ln_2): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (mlp): MLP(
        (linear_pre): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): GELU(approximate=False)
        )
        (linear_post): Linear(in_features=256, out_features=256, dtype=None)
        (linears): LayerList()
      )
    )
    (4): Transolver_block(
      (ln_1): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (Attn): Physics_Attention_Structured_Mesh_2D(
        (softmax): Softmax(axis=-1)
        (dropout): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        (in_project_x): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_fx): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_slice): Linear(in_features=32, out_features=32, dtype=None)
        (to_q): Linear(in_features=32, out_features=32, dtype=None)
        (to_k): Linear(in_features=32, out_features=32, dtype=None)
        (to_v): Linear(in_features=32, out_features=32, dtype=None)
        (to_out): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        )
      )
      (ln_2): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (mlp): MLP(
        (linear_pre): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): GELU(approximate=False)
        )
        (linear_post): Linear(in_features=256, out_features=256, dtype=None)
        (linears): LayerList()
      )
    )
    (5): Transolver_block(
      (ln_1): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (Attn): Physics_Attention_Structured_Mesh_2D(
        (softmax): Softmax(axis=-1)
        (dropout): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        (in_project_x): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_fx): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_slice): Linear(in_features=32, out_features=32, dtype=None)
        (to_q): Linear(in_features=32, out_features=32, dtype=None)
        (to_k): Linear(in_features=32, out_features=32, dtype=None)
        (to_v): Linear(in_features=32, out_features=32, dtype=None)
        (to_out): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        )
      )
      (ln_2): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (mlp): MLP(
        (linear_pre): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): GELU(approximate=False)
        )
        (linear_post): Linear(in_features=256, out_features=256, dtype=None)
        (linears): LayerList()
      )
    )
    (6): Transolver_block(
      (ln_1): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (Attn): Physics_Attention_Structured_Mesh_2D(
        (softmax): Softmax(axis=-1)
        (dropout): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        (in_project_x): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_fx): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_slice): Linear(in_features=32, out_features=32, dtype=None)
        (to_q): Linear(in_features=32, out_features=32, dtype=None)
        (to_k): Linear(in_features=32, out_features=32, dtype=None)
        (to_v): Linear(in_features=32, out_features=32, dtype=None)
        (to_out): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        )
      )
      (ln_2): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (mlp): MLP(
        (linear_pre): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): GELU(approximate=False)
        )
        (linear_post): Linear(in_features=256, out_features=256, dtype=None)
        (linears): LayerList()
      )
    )
    (7): Transolver_block(
      (ln_1): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (Attn): Physics_Attention_Structured_Mesh_2D(
        (softmax): Softmax(axis=-1)
        (dropout): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        (in_project_x): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_fx): Conv2D(256, 256, kernel_size=[3, 3], padding=1, data_format=NCHW)
        (in_project_slice): Linear(in_features=32, out_features=32, dtype=None)
        (to_q): Linear(in_features=32, out_features=32, dtype=None)
        (to_k): Linear(in_features=32, out_features=32, dtype=None)
        (to_v): Linear(in_features=32, out_features=32, dtype=None)
        (to_out): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): Dropout(p=0.0, axis=None, mode=upscale_in_train)
        )
      )
      (ln_2): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (mlp): MLP(
        (linear_pre): Sequential(
          (0): Linear(in_features=256, out_features=256, dtype=None)
          (1): GELU(approximate=False)
        )
        (linear_post): Linear(in_features=256, out_features=256, dtype=None)
        (linears): LayerList()
      )
      (ln_3): LayerNorm(normalized_shape=[256], epsilon=1e-05)
      (mlp2): Linear(in_features=256, out_features=1, dtype=None)
    )
  )
)
Total Trainable Params: 11232321
1
2
3
4
5
6
7
8
9
0.08822000566869974

